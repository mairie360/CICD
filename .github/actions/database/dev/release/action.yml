name: Database Dev Release Action
description: 'Action to release database package in dev environment'

inputs:
  package_name:
    description: 'Name of the package'
    required: true
  github_token:
    description: 'GitHub token for authentication'
    required: true
  ref:
    description: 'Branch or tag of the CICD repository to checkout'
    required: true

runs:
  using: "composite"
  steps:
    # Checkout CICD repo so local docker actions exist
    - name: Checkout CICD repository
      uses: actions/checkout@v4
      with:
        repository: mairie360/CICD
        ref: ${{ inputs.ref }}

    # Build Docker image
    - name: Build Docker image
      uses: ./../../docker/build
      with:
        package_name: ${{ inputs.package_name }}
        environment: dev
        github_token: ${{ inputs.github_token }}

    # Publish Docker image
    - name: Publish Docker image
      uses: ./../../docker/publish
      with:
        package_name: ${{ inputs.package_name }}
        environment: dev
        github_token: ${{ inputs.github_token }}
